# UOJ阶段总结(2) 调库
## 1. 校验器val.cpp
对于输入的校验控制，保证输入合法
* 使用testlib.h
* 在```registerValidation()```之后获得了流inf，通过流的以下函数调用检验
或者调用```ensuref()```：
```cpp
ensuref(cmd=='Q' || cmd=='A' || cmd=='C' , "您输入的操作不合法");
```
| 函数                                         | 功能                                                                             |
|:---------------------------------------------|:---------------------------------------------------------------------------------|
| void registerValidation()                    | 初始化，应该在程序开始时调用                                                     |
| char readChar()                              | 读取一个字符                                                                   | |
| char readChar(char ch)                       | 读取一个字符，必须是指定的ch                                            |        |
| char readSpace()                             | 读取一个空格                                                                  |  |
| void unreadChar(char ch)                     | 将ch添加到输入流的最后面                                              |          |
| string readToken()                           | 读取一个字符串，相当于scanf中的%s                                           |    |
| string readToken(string regex)               | 读取一个字符串，必须满足给定的表达式regex，表达式语法类似于正则 |                |
| string readWord() 	同readToken()              |                                                                                  |
| string readWord(string regex)                | 同readToken(string regex)                                        |               |
| long long readLong()                         | 读取一个long long变量                                                     |      |
| long long readLong(long long L, long long R) | 读取一个long long变量，必须在[L,R]以内            |                              |
| int readInt()或readInteger()                 | 读取一个int变量                                                   |              |
| int readInt(int L, int R)                    | 读取一个int变量，必须在[L,R]以内                                     |           |
| double readDouble()或readReal()              | 读取一个double类型变量                                         |                 |
| double readDouble(double L, double R)        | 读取一个double类型变量，必须在[L,R]以内                  |                       |
| string readLine()或readString()              | 读取一整行，相当于gets()                                       |                 |
| string readLine(string regex)                | 读取一整行，必须满足给定的表达式regex                            |               |
| void readEoln()                              | 读取一个换行符               |                                                   |
| void readEof()                               | 读取文件结束符                                                                   |

## 2.答案校验器chk.cpp


>自定义校验器时注意在problem.conf中去掉use_builtin_checker那一行

1. 开始
```cpp
registerTestlibCmd(argc, argv);
```
从而获得三个流
* ```inf```： 输入数据
* ```ouf``` ： 选手输出
* ```ans``` ： 标准输出
2. 接下来从流中获取数据
函数同校验器，例如
```cpp
int pans,jans;
pans=ouf.readInt();      // 读取选手输出
jans=ans.readInt();      // 读取答案
```
3. 返回结果
```cpp
quitf(_ok, "Correct.");
quitf(_wa, "WA! expect=%d recieve=%d", jans, pans);
```

## 3.main_judger
* uoj_judger.h
* uoj_env.h

这里怎么说好呢，很多跨文件的数据结构被做成全局的，然后被统一init，个人觉得如果封装一下会更好
### 1) main_judger_init(argc,argv)
初始化
main_path=...
work_path=...
result_path=...
data_path=...
problem_id=...
config["judger"]=...

* load_config:
submission.conf
problem.conf
### 2)run_program(...)
明天再写