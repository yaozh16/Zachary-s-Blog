<!DOCTYPE html>
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width"><link rel="stylesheet" type="text/css" media="all" href="../css/article_styles.css"><script type='text/x-mathjax-config'>  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script><script type='text/javascript' src='http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script></head>
<body><div class='content'><h1 id="ROS learning [2]">ROS learning [2]</h1>
<h2 id="Writing a Simple Publisher and Subscriber (Python)">Writing a Simple Publisher and Subscriber (Python)</h2><div class="ulRank0"><ul class="ulRank0">1. create code in [package]/scripts/ folder</ul></div>
<div class='codeBlock'><pre class='codeBlockPre'><blockquote>roscd beginner_tutorials
mkdir scripts
cd scripts
wget https://raw.github.com/ros/ros_tutorials/kinetic-devel/rospy_tutorials/001_talker_listener/talker.py
wget https://raw.github.com/ros/ros_tutorials/kinetic-devel/rospy_tutorials/001_talker_listener/listener.py
chmod +x talker.py
chmod +x listener.py
</blockquote></pre></div>
<h3 id="import rospy">import rospy</h3>
<h3 id="Publisher">Publisher</h3><div class="ulRank0"><ul class="ulRank0">1. 创建publisher</ul></div>
pub = rospy.Publisher([TopicName], [MessageType], queue_size=10)<div class="ulRank0"><ul class="ulRank0">2. 创建node</ul></div>
rospy.init_node([Node Name], anonymous=True)<div class="ulRank0"><ul class="ulRank0">3. 配置周期</ul></div>
rate = rospy.Rate(10)<div class="ulRank0"><ul class="ulRank0">4. 发送消息</ul></div>
<div class='codeBlock'><pre class='codeBlockPre'><blockquote>while not rospy.is_shutdown():
      hello_str = &quot;hello world %s&quot; % rospy.get_time()
      rospy.loginfo(hello_str) <h1 id="输出到屏幕、log、rosout">输出到屏幕、log、rosout</h1>
      pub.publish(hello_str)
      rate.sleep()
</blockquote></pre></div>
消息也可以直接先默认创建然后修改data域

<h3 id="Subscriber">Subscriber</h3><div class="ulRank0"><ul class="ulRank0">1. 创建node</ul></div>
rospy.init_node([node name]'listener', anonymous=True)<div class="ulRank0"><ul class="ulRank0">2. 订阅topic</ul></div>
rospy.Subscriber([topic name]"chatter", [Message Type]String, callback)
其中callback的参数类型就是MessageType
调用其中的data域获取原始值
<div class='codeBlock'><pre class='codeBlockPre'><blockquote>def callback(data):
    rospy.loginfo(rospy.get_caller_id() + &apos;I heard %s&apos;, data.data)
</blockquote></pre></div><div class="ulRank0"><ul class="ulRank0">3. 运行</ul></div>
rospy.spin()
<h2 id="Examining the Simple Publisher and Subscriber">Examining the Simple Publisher and Subscriber</h2>
<div class='codeBlock'><pre class='codeBlockPre'><blockquote>roscore
rosrun beginner_tutorials talker.py
rosrun beginner_tutorials listener.py
</blockquote></pre></div>
</div></body>
</html>
